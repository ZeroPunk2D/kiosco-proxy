import UIKit

class ConfigViewController: UIViewController {

    let txtURL = UITextField()
    let txtEmpresa = UITextField()
    let switchAuto = UISwitch()

    override func viewDidLoad() {
        super.viewDidLoad()

        view.backgroundColor = .white
        crearUI()
    }

    func crearUI() {

        let titulo = UILabel(frame: CGRect(x: 40, y: 80, width: 400, height: 40))
        titulo.text = "Configuración"
        titulo.font = UIFont.boldSystemFont(ofSize: 24)
        view.addSubview(titulo)

        // URL Inicio
        txtURL.placeholder = "URL Inicio (https://...)"
        txtURL.borderStyle = .roundedRect
        txtURL.frame = CGRect(x: 40, y: 150, width: 400, height: 40)
        txtURL.text = UserDefaults.standard.string(forKey: "urlInicio")
        view.addSubview(txtURL)

        // ID Empresa
        let lblEmpresa = UILabel(frame: CGRect(x: 40, y: 200, width: 300, height: 30))
        lblEmpresa.text = "ID Empresa"
        view.addSubview(lblEmpresa)

        txtEmpresa.placeholder = "Ejemplo: 414"
        txtEmpresa.borderStyle = .roundedRect
        txtEmpresa.keyboardType = .numberPad
        txtEmpresa.frame = CGRect(x: 40, y: 230, width: 400, height: 40)
        txtEmpresa.text = UserDefaults.standard.string(forKey: "empresaID")
        view.addSubview(txtEmpresa)

        // Auto Inicio
        let lblAuto = UILabel(frame: CGRect(x: 40, y: 290, width: 300, height: 40))
        lblAuto.text = "Iniciar automáticamente"
        view.addSubview(lblAuto)

        switchAuto.frame = CGRect(x: 340, y: 290, width: 50, height: 40)
        switchAuto.isOn = UserDefaults.standard.bool(forKey: "autoInicio")
        view.addSubview(switchAuto)

        // Botón Guardar
        let btnGuardar = UIButton(type: .system)
        btnGuardar.setTitle("Guardar", for: .normal)
        btnGuardar.frame = CGRect(x: 40, y: 360, width: 100, height: 40)
        btnGuardar.addTarget(self, action: #selector(guardar), for: .touchUpInside)
        view.addSubview(btnGuardar)

        // Botón Cerrar
        let btnCerrar = UIButton(type: .system)
        btnCerrar.setTitle("Cerrar", for: .normal)
        btnCerrar.frame = CGRect(x: 160, y: 360, width: 100, height: 40)
        btnCerrar.addTarget(self, action: #selector(cerrar), for: .touchUpInside)
        view.addSubview(btnCerrar)

        // Botón Salir
        let btnSalir = UIButton(type: .system)
        btnSalir.setTitle("Salir App", for: .normal)
        btnSalir.frame = CGRect(x: 280, y: 360, width: 120, height: 40)
        btnSalir.addTarget(self, action: #selector(salirApp), for: .touchUpInside)
        view.addSubview(btnSalir)
    }

    @objc func guardar() {

        UserDefaults.standard.set(txtURL.text, forKey: "urlInicio")
        UserDefaults.standard.set(txtEmpresa.text, forKey: "empresaID")
        UserDefaults.standard.set(switchAuto.isOn, forKey: "autoInicio")

        UserDefaults.standard.synchronize()

        dismiss(animated: true)
    }

    @objc func cerrar() {
        dismiss(animated: true)
    }

    @objc func salirApp() {
        exit(0)
    }
}